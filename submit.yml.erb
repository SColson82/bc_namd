---
<%# Takes user input from form.yml and sets variables for the script arguments. %>
<%-
  ppn = num_tasks_per_node.blank? ? 1 : num_tasks_per_node.to_i
  nodes = num_nodes.blank? ? 1 : num_nodes.to_i
  mem = gbs_of_mem.blank? ? (2*ppn) : gbs_of_mem.to_i  

  slurm_args = [ "--nodes", "#{nodes}", "--ntasks-per-node", "#{ppn}", "--mem", "#{mem}G",]
-%>

batch_connect:
  template: "basic"
  conn_params:
    - working_path
script:
  accounting_id: <%= bc_account %>
  native:
  <%- slurm_args.each do |arg| %>
    - "<%= arg %>"
  <%- end %>

